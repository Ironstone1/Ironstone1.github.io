<!DOCTYPE html>
<html lang="en-GB">
	<head>
		<title>Build a computer - part chooser</title>
		<meta charset="UTF-8"/>
		<meta name="viewport" content="width=device-width, initial-scale=1.0" ></meta>
		<meta name="description" content="Build a computer, choose your parts" ></meta>
		<meta name="keywords" content="PC,Computer,PartPicker" ></meta>
		<meta name="author" content="Jared" ></meta>
		<meta name="robots" content="index, follow" ></meta>
		<meta name="referrer" content="default" ></meta>
		<meta name="" content="" ></meta>
	</head>
	
	<script>
		var page_num = 1;
		var part_types = ["cpu.txt", "mobo.txt", "ram.txt", "gpu.txt", "hdd.txt", "sdd.txt", "psu.txt", "case.txt"];
	</script>
	
	<script>
		function getData(fileName, criteria) {
			var request = new XMLHttpRequest();
			request.onreadystatechange = function() {
				var response = request.responseText.split("\n");
				if (response == "") {return;}
				
				var tbody = document.createElement("tbody");tbody.id = "tableBody";
				document.getElementById("dataTable").innerHTML = "";
				document.getElementById("dataTable").data = fileName;
				var CPU_list = [];
				
				//create table head
				thead = document.createElement("thead");thead.id = "tableHead";
				thead.innerHTML = "<th>+</th><th>" + response[0].replace(/,/g, "</th><th>") + "</th>";
				document.getElementById("dataTable").appendChild(thead);
				
				for (i=1;i<response.length;i++) {
				
					//check validity
					switch (fileName) {
						case "cpu.txt":
							// check that CPU socket and motherboard socket are compatible.
							break;
						
						case "mobo.txt":
							// check that the motherboard form factor and case form factor are compatible.
							// - smaller motherboard form factors fit larger cases, (e.g. mini-itx mobo in atx case).
							// enough PCI slots for expansions cards (e.g. sound card, network card).
							// - are the PCI slots compatible with the card (e.g. PCI x4 in PCI x16).
							break;
						
						case "ram.txt":
							// enough RAM slots for each module (e.g. 2x8 ram kit on 4x8 mobo).
							// is total RAM size less than motherboard maximum RAM.
							// is RAM DDR compatible (DDR 2/3/4).
							// is RAM frequency compatible with motherboard.
							break;
						
						case "gpu.txt":
							// Is there a x16 PCIe slot on the motherboard.
							// Is there enough PCIe slots to fit multiple GPUs.
							break;
						
						case "hdd.txt":
							// enough SATA ports on the motherboard.
							break;
						
						case "ssd.txt":
							// enough SATA ports on the motherboard.
							break;
						
						case "psu.txt":
							// does the PSU provide enough wattage for every component (total watts < max PSU watts).
							break;
						
						case "case.txt":
							// check that the case form factor and motherboard form factor are compatible.
							break;
					}
				
					// check if item meets search criteria.
					/*if (criteria == "") {
						CPU_list.push(response[i].split(","));
					} else if (criteria == "none") {
						document.getElementById("NoSearchResults").innerHTML = "No search Results!";
						return;
					} else if (response[i].toLocaleLowerCase().indexOf(criteria.toLocaleLowerCase()) != -1) {
						CPU_list.push(response[i].split(","));
					}*/
				}
				
				for (i=0;i<CPU_list.length;i++) {
					// add to part list button
					var tr = document.createElement("tr");
					var div = document.createElement("div");
					div.innerHTML = "<input type='button' onclick='Add2PartList("+i+", \""+fileName+"\")' value='+' id='bttn_"+i+"'></input>"
					tr.appendChild(div);
					tr.id = "row_" + i;
					
					// create new table row, add item to document
					for (index=0;index < CPU_list[i].length; index++) {
						td = document.createElement("td");
						td.innerHTML = CPU_list[i][index];
						tr.appendChild(td);
					} tbody.appendChild(tr);
				} 
				document.getElementById("dataTable").appendChild(tbody);
				NextPage('show-table');
			}
			request.open("GET", "https://ironstone1.github.io/U28A3Project/" + fileName);
			request.send();
		}
		
		function AddCustomPart() {
			partName = prompt("Enter the name of your custom part: ");
			if (partName == null) {return;}
			text = "select your parts category:\n1. Processor (CPU)\n2. Motherboard\n3. Memory (RAM)\n4. Graphics card (GPU)\n5. Hard drive (HDD)\n6. Solid State (SSD)\n7. power supply (PSU)\n8. Other";
			UserInput = prompt(text);
			while (["1","2","3","4","5","6","7", "8"].indexOf(UserInput) == -1) {
				if (UserInput == null) {return;}
				UserInput = prompt("Invalid Input, Please Try Again!\n" + text);
			} if (parseInt(UserInput) == 8) {
				elm = document.createElement("div");
				elm.innerHTML = partName;
				document.getElementById("custom-elm-div").insertBefore(elm, document.getElementById("custom-elm-div").firstChild);
			} else {
				document.getElementById(part_types.join("&&").replace(/.txt/g, "-elm").split("&&")[parseInt(UserInput)-1]).outerHTML = partName;
			}
		}
		
		function Add2PartList(ItemIndex, Fname) {
			NameIndex = document.getElementById("dataTable").children[0].children[0].innerHTML.split("</th><th>").indexOf("Name");
			Name =		document.getElementById("dataTable").children[1].children[ItemIndex].children[NameIndex].innerHTML;
			if (confirm("Are you sure you want to add '" + Name + "' to your part list?\npress OK to continue or cancel to decline!") == true) {
				var elm = document.getElementById(Fname.replace(".txt","")+"-elm");
				if (elm == null) {
					alert("Failed to add '"+Name+"' to your part list!");
				} else {
					localStorage.setItem(Fname, document.getElementById("row_" + ItemIndex).innerText.replace(/\t/g, ",").slice(1));
					document.getElementById("search4part").value = "";
					elm.outerHTML = Name;
				}
			}
		}
		
		function RemovePart(PartIndex) {
			NameIndex = function(n){if (n == 0){return 1} else {return 0}};
			Name = localStorage.getItem(part_types[PartIndex]).split(",")[NameIndex(PartIndex)];
			elm_text = ["Processor", "Motherboard", "RAM kit", "Graphics Card", "Hard Disk Drive", "Solid State Drive", "Power Supply Unit", "Case"];
			
			if (Name == undefined || Name == "" || Name == null) {
				alert("Failed to remove part from part list!\nNo " + elm_text[PartIndex] + " selected!");
			} else if (confirm("Are you sure you want to remove '" + Name + "' from the part list?\npress OK to continue or cancel to decline!") == true) {
				localStorage.setItem(part_types[PartIndex], "");
				bttn_html = '<button class="select_button" id="' + part_types[PartIndex].replace(".txt", "-elm") + '" onclick="getData(\'' + part_types[PartIndex] + '\', \'\')">' + 'Select a ' + elm_text[PartIndex] + '</button>';
				document.getElementById(part_types[PartIndex].replace(/.txt/g, "-td")).innerHTML = bttn_html;
			}
		}
		
		function NextPage(NextPrevious) {
			total_no = document.getElementById("tableBody").children.length;
			ItemsPerPage = document.getElementById("ItemsPerPage").value;
			if (NextPrevious == "next" && page_num < parseInt(total_no / ItemsPerPage)) {
				page_num++;
			} else if (NextPrevious == "back" && page_num > 1) {
				page_num--;
			} else if (NextPrevious == "show-table") {
				document.getElementById("tableContainer").style.display = "";
			}
			
			for (i=0;i<total_no;i++) {
				if (ItemsPerPage == "all") {
					document.getElementById("row_" + i).style.display = "";
				} else if (i >= (page_num-1)*parseInt(ItemsPerPage)+1 && i <= (page_num*parseInt(ItemsPerPage))) {
					document.getElementById("row_" + i).style.display = "";
				} else {
					document.getElementById("row_" + i).style.display = "none";
				}
			}
		}
		
		// To do:
		// clear search box after you type *
		// add images for each part
		// add custom part *
		// show cpu show socket
		// add validation for each part.
		// add filters
		// show detailed information for each part (spec sheet).
		// only display 100 rows at a time, add next/previous buttons *
		// redirect to shop
		
			//("<thead><th>" + response[0].replace(",", "</th><th>") + "</th></thead>");
			
			//compatibility, which mobo fits which cpu, etc.
		
			/*//form
			// Enter the part name.
			// Drop down list (Select type) - CPU, GPU, RAM, etc...
			
			//JS fetch:
			//Part			$("tbody[id='category_content'] tr td[class='tdname'] a")[0].innerHTML
			//Clock speed	$("tbody[id='category_content'] td[style='text-align:left;']")[0].innerHTML
			//Cores			$("tbody[id='category_content'] td[style='text-align:center;']")[0].innerHTML
			//https://pcpartpicker.com/products/cpu/
			
			// CASE, CPU cooler?*/
		
		/*function get() {
			var elm = "";
			for (i=0;i<$("tbody[id='category_content'] tr").length;i++) {
				//part 	= $("tbody[id='category_content'] tr td[class='tdname'] a")[i].innerHTML;
				//clock 	= $("tbody[id='category_content'] td[style='text-align:left;']")[i].innerHTML;
				//cores	= $("tbody[id='category_content'] td[style='text-align:center;']")[i].innerHTML;
				
				i1 = $("tbody[id='category_content'] tr")[i].children[1].children[0].innerHTML;
				i2 = $("tbody[id='category_content'] tr")[i].children[2].innerHTML;
				i3 = $("tbody[id='category_content'] tr")[i].children[3].innerHTML;
				i4 = $("tbody[id='category_content'] tr")[i].children[4].innerHTML;
				i5 = $("tbody[id='category_content'] tr")[i].children[5].innerHTML;
				
				
				//elm += "\n<tr>\n\t<td>" + part + "</td>\n\t<td>" + clock + "</td>\n\t<td>" + cores + "</td>\n</tr>";
				//elm += part + "," + clock + "," + cores + "\n";
				elm += i1 + "," + i2 + "," + i3 + "," + i4 + "," + i5 + "\n";
			}
			console.log(elm);
		}*/
		
	</script>
	
	<style>
		.select_button {
			background-color: green;
			color: white;
		}
		
		.select_head {
			font-family: arial black;
		}
		
		.table_head {
			font-family: arial;
		}
		
		.table_head_last {
			font-family: arial;
			width: 1%;
		}
		
		.main_head {
			font-family: Arial black;
			text-decoration: none;
			color: white;
		}
		
		.main_title_div {
			background-color: green;
			padding-bottom: 1em;
			padding-top: 1em;
			padding-left: 5%;
			padding-right: 5%;
		}
		
		.table-div {
			padding-bottom: 0%;
			padding-top: 0%;
			padding-left: 2%;
			padding-right: 0%;
		}
		
		body {
			background-color: white;
		}
		
		.green_stripe {
			background-color: #ECFFEC;
		}
		
		.white_stripe {
			background-color: #FBFBFB;
		}
		
	</style>
	
	<body>
		<div class="main_title_div">
			<h1 class="main_head">Computer Part List</h1>
		</div>
		<div class="table-div">	
			<table border="1px solid black" width="100%" id="select_table">
				<thead>
					<tr>
						<th class="table_head">Type</th>
						<th class="table_head">Part</th>
						<th class="table_head">Buy</th>
						<th class="table_head_last">-</th>
					</tr>
				</thead>
			
				<tbody>
					<tr class="green_stripe">
						<td class="select_head">CPU</td>
						<td id="cpu-td">
							<button class="select_button" id="cpu-elm" onclick="getData('cpu.txt','')">Select a Processor</button>
						</td>
						<td></td>
						<td><input type="button" onclick="RemovePart(0)" value="-" id="remove_bttn_0"></input></td>
					</tr>
					<tr class="white_stripe">
						<td class="select_head">MOBO</td>
						<td id="mobo-td">
							<button class="select_button" id="mobo-elm" onclick="getData('mobo.txt','')">Select a Motherboard</button>
						</td>
						<td></td>
						<td><input type="button" onclick="RemovePart(1)" value="-" id="remove_bttn_1"></input></td>
					</tr>
					<tr class="green_stripe">
						<td class="select_head">RAM</td>
						<td id="ram-td">
							<button class="select_button" id="ram-elm" onclick="getData('ram.txt','')">Select a RAM kit</button>
						</td>
						<td></td>
						<td><input type="button" onclick="RemovePart(2)" value="-" id="remove_bttn_2"></input></td>
					</tr>
					<tr class="white_stripe">
						<td class="select_head">GPU</td>
						<td id="gpu-td">
							<button class="select_button" id="gpu-elm" onclick="getData('gpu.txt','')">Select a Graphics Card</button>
						</td>
						<td></td>
						<td><input type="button" onclick="RemovePart(3)" value="-" id="remove_bttn_3"></input></td>
					</tr>
					<tr class="green_stripe">
						<td class="select_head">HDD</td>
						<td id="hdd-td">
							<button class="select_button" id="hdd-elm" onclick="getData('hdd.txt','')">Select a Hard Disk Drive</button>
						</td>
						<td></td>
						<td><input type="button" onclick="RemovePart(4)" value="-" id="remove_bttn_4"></input></td>
					</tr>
					<tr class="white_stripe">
						<td class="select_head">SSD</td>
						<td id="ssd-td">
							<button class="select_button" id="ssd-elm" onclick="getData('ssd.txt','')">Select a Solid State Drive</button>
						</td>
						<td></td>
						<td><input type="button" onclick="RemovePart(5)" value="-" id="remove_bttn_5"></input></td>
					</tr>
					<tr class="green_stripe">
						<td class="select_head">PSU</td>
						<td id="psu-td">
							<button class="select_button" id="psu-elm" onclick="getData('psu.txt','')">Select a Power Supply Unit</button>
						</td>
						<td></td>
						<td><input type="button" onclick="RemovePart(6)" value="-" id="remove_bttn_6"></input></td>
					</tr>
					<tr class="white_stripe">
						<td class="select_head">CASE</td>
						<td id="case-td">
							<button class="select_button" id="case-elm" onclick="getData('case.txt', '')">Select a Case</button>
						</td>
						<td></td>
						<td><input type="button" onclick="RemovePart(7)" value="-" id="remove_bttn_7"></input></td>
					</tr>
					<tr class="green_stripe">
						<td class="select_head">Custom</td>
						<td id="custom-elm-div">
							<button class="select_button" id="custom-elm" onclick="AddCustomPart()">Add a custom part</button>
						</td>
						<td></td>
						<td><input type="button" onclick="RemovePart(8)" value="-" id="remove_bttn_8"></input></td>
					</tr>
				</tbody>
			</table>
		</div>
		
		<div id="tableContainer" style="display: none;">
			<input type="text" name="search" placeholder="Search for a part" id="search4part"></input>
			<input type="button" name="search" value="Search" onclick="getData(document.getElementById('dataTable').data, document.getElementById('search4part').value);"></input>
			
			<div>
				<table border="1px solid black" width="100%" id="dataTable">
				</table>
				<p id="NoSearchResults"></p>
				<div>
					<input type="button" name="back" value="back" onclick="NextPage('back')"></input>/
					<input type="button" name="next" value="next" onclick="NextPage('next')"></input>
					<select name="ItemsPerPage" id="ItemsPerPage" onchange="NextPage('back')">
						<option value="5">5</option>
						<option value="10">10</option>
						<option value="20" selected="selected">20</option>
						<option value="50">50</option>
						<option value="100">100</option>
						<option value="200">200</option>
						<option value="500">500</option>
						<option value="all">all</option>
					</select>
				</div>
			</div>
		</div>
		
	</body>
</html>